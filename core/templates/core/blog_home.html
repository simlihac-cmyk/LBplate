{% extends 'core/base.html' %}
{% load static %}

{% block title %}Blog - ë¯¸ìƒë¬¼ì˜ ë˜‘ë˜‘í•œ í•˜ë£¨{% endblock %}

{% block content %}
<div class="container">
    <div class="card col-2 no-click" id="blog-intro">
        <span class="card-label">About Blog</span>
        <h2 class="card-title" style="margin-top: 10px;">ë¯¸ìƒë¬¼ì˜ ë˜‘ë˜‘í•œ í•˜ë£¨</h2>
        <p style="font-size: 0.9rem; color: var(--text-dim); line-height: 1.5; margin-top: 10px;">
            LB plateì˜ ê°œì¸ ì—°êµ¬ ê¸°ë¡ ë° ì¼ìƒ ì¼ì§€ì…ë‹ˆë‹¤.<br>
            ë¯¸ìƒë¬¼ì²˜ëŸ¼ ì‘ì§€ë§Œ ì†Œì¤‘í•œ í•˜ë£¨ì˜ ë°ì´í„°ë“¤ì„ ì°¨ê³¡ì°¨ê³¡ ìŒ“ì•„ê°‘ë‹ˆë‹¤. </p>
    </div>

    <div class="card col-2" id="blog-search">
        <span class="card-label">Search</span>
        <form method="GET" action="{% url 'blog_home' %}" class="bento-search-form">
            <input type="text" name="search" placeholder="í‚¤ì›Œë“œë¡œ ê¸°ë¡ ì°¾ê¸°..." value="{{ search_query|default:'' }}">
            <button type="submit">ğŸ”</button>
        </form>
        <div class="category-quick-tags" style="margin-top: 15px;">
            {% for cat in categories|slice:":5" %}
                <a href="{% url 'blog_home' %}?category={{ cat.id }}" class="mini-tag">{{ cat.name }}</a>
            {% endfor %}
        </div>
    </div>

    {% if posts %}
        {% for post in posts %}
        <a href="{% url 'post_detail' post.id %}" class="card-wrapper col-2">
            <div class="card post-full-card">
                <span class="card-label">{{ post.date|slice:":10" }}</span>
                <h2 class="card-title">{{ post.title.rendered|truncatechars:40 }}</h2>
                <p class="post-summary">{{ post.excerpt.rendered|striptags|truncatechars:100 }}</p>
                <div class="util-icon">ğŸ“„</div>
            </div>
        </a>
        {% endfor %}
    {% else %}
        <div class="card col-4" style="text-align: center; padding: 60px;">
            <p style="color: var(--text-dim);">í•´ë‹¹í•˜ëŠ” ê¸°ë¡ì´ ì•„ì§ ì—†ìŠµë‹ˆë‹¤. ğŸ¦ </p>
        </div>
    {% endif %}

    {% if total_pages > 1 %}
    <div class="card col-4 pagination-card">
        <div class="pagination-wrapper">
            {% if current_page > 1 %}
                <a href="{% url 'blog_home' %}?page={{ current_page|add:'-1' }}{% if search_query %}&search={{ search_query }}{% endif %}" class="page-link">Prev</a>
            {% endif %}
            
            {% for p in page_range %}
                <a href="{% url 'blog_home' %}?page={{ p }}{% if search_query %}&search={{ search_query }}{% endif %}"
                   class="page-link {% if current_page == p %}active{% endif %}">
                    {{ p }}
                </a>
            {% endfor %}

            {% if current_page < total_pages %}
                <a href="{% url 'blog_home' %}?page={{ current_page|add:'1' }}{% if search_query %}&search={{ search_query }}{% endif %}" class="page-link">Next</a>
            {% endif %}
        </div>
    </div>
    {% endif %}
</div>

<style>
    /* ë¸”ë¡œê·¸ ì†Œê°œ ì „ìš© (í´ë¦­ ë°©ì§€) */
    .no-click {
        cursor: default;
        pointer-events: none;
    }
    .no-click .card-title { pointer-events: auto; } /* í…ìŠ¤íŠ¸ ì„ íƒì€ ê°€ëŠ¥í•˜ê²Œ */

    /* ê²€ìƒ‰ì°½ ìŠ¤íƒ€ì¼ */
    .bento-search-form {
        display: flex;
        background: var(--bg-color);
        border-radius: 12px;
        margin-top: 15px;
        padding: 5px 15px;
        border: 1px solid rgba(0,0,0,0.05);
    }
    .bento-search-form input {
        flex: 1; border: none; background: transparent; padding: 10px; outline: none; color: var(--text-color);
    }
    .bento-search-form button {
        background: transparent; border: none; cursor: pointer; font-size: 1.1rem;
    }

    /* ë¯¸ë‹ˆ ì¹´í…Œê³ ë¦¬ íƒœê·¸ */
    .mini-tag {
        display: inline-block;
        font-size: 0.75rem;
        padding: 4px 10px;
        background: var(--bg-color);
        border-radius: 6px;
        text-decoration: none;
        color: var(--text-dim);
        margin-right: 5px;
        transition: 0.2s;
        pointer-events: auto;
    }
    .mini-tag:hover { background: var(--accent-color); color: white; }

    /* í¬ìŠ¤íŠ¸ ì¹´ë“œ ë³´ì • */
    .post-full-card {
        height: 100%;
        transition: all 0.3s ease;
    }
    .card-wrapper:hover .post-full-card {
        transform: translateY(-5px);
        box-shadow: 0 15px 30px rgba(0,0,0,0.08);
    }
    .post-summary {
        font-size: 0.85rem;
        color: var(--text-dim);
        margin-top: 12px;
        line-height: 1.6;
    }

    /* í˜ì´ì§€ë„¤ì´ì…˜ */
    .pagination-wrapper { display: flex; justify-content: center; gap: 10px; }
    .page-link {
        text-decoration: none; padding: 8px 15px; border-radius: 8px;
        background: var(--bg-color); color: var(--text-color); font-weight: 600; font-size: 0.85rem;
    }
    .page-link.active { background: var(--accent-color); color: white; }
</style>
{% endblock %}